{% extends 'base.html' %}

{% block titulo %}Editar publicación - Blog de Videojuegos{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm p-4 bg-dark text-light rounded">
    <h2 class="mb-4 text-center">✏️ Editar publicación</h2>

    <form method="post" enctype="multipart/form-data" novalidate>
      {% csrf_token %}

      <div class="mb-3">
        <label for="{{ form.titulo.id_for_label }}" class="form-label">Título</label>
        {{ form.titulo }}
      </div>

      <div class="mb-3">
        <label for="{{ form.categoria.id_for_label }}" class="form-label">Categoría</label>
        {{ form.categoria }}
      </div>

      <div class="mb-3">
        <label for="id_contenido" class="form-label">Contenido</label>
        <!-- IMPORTANTE: escapar el HTML para no romper el atributo -->
        <input type="hidden" id="id_contenido" name="contenido" value="{{ form.initial.contenido|default_if_none:''|escape }}">
        <trix-editor input="id_contenido" class="bg-light text-dark p-2 rounded"></trix-editor>
      </div>

      <div class="mb-3">
        <label for="id_tags" class="form-label">Etiquetas</label>
        <input type="text" name="tags" id="id_tags" class="form-control"
               value="{{ form.initial.tags|default:'' }}">
        <small class="form-text text-muted">Separá las etiquetas con comas. Ej: acción, aventuras, indie</small>
      </div>

      <div class="mb-3">
        <label for="{{ form.imagen.id_for_label }}" class="form-label">Imagen destacada</label>
        {{ form.imagen }}
        {% if post.imagen %}
          <div class="mt-2">
            <strong>Imagen actual:</strong><br>
            <img src="{{ post.imagen.url }}" class="img-fluid rounded mt-2" style="max-height: 200px;" alt="Imagen actual">
          </div>
        {% endif %}
      </div>

      <div class="d-grid mt-4">
        <button type="submit" class="btn btn-primary btn-lg">
          <i class="bi bi-check-circle"></i> Guardar cambios
        </button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
